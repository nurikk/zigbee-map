!function(){"use strict";var t;!function(t){!function(t){t[t.Main=0]="Main",t[t.Battery=1]="Battery"}(t.PowerSourceType||(t.PowerSourceType={})),function(t){t[t.EndDevice=0]="EndDevice",t[t.Router=1]="Router",t[t.Coordinator=2]="Coordinator"}(t.DeviceType||(t.DeviceType={}))}(t||(t={}));var e={ieeeAddr:"",last_seen:"",type:t.DeviceType.Coordinator,powerSource:t.PowerSourceType.Main,ManufName:"sls",ModelId:"sls",st:{linkquality:1,trSeqNum:1,warning:"",battery:1,voltage:1},supported:1,friendly_name:"sls gateway"};!function(){var t,n,r,a,i=d3.scaleOrdinal(d3.schemeCategory10),o=d3.select("svg"),c=+o.attr("width"),l=+o.attr("height"),s=d3.forceSimulation().force("link",d3.forceLink().id((function(t){return t.id})).distance(50).strength(.1)).force("charge",d3.forceManyBody().distanceMin(10).strength(-300)).force("center",d3.forceCenter(c/2,l/2));function d(){n.attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})),t.attr("transform",(function(t){return"translate("+t.x+", "+t.y+")"})),r.attr("d",(function(t){return"M "+t.source.x+" "+t.source.y+" L "+t.target.x+" "+t.target.y})),a.attr("transform",(function(t){if(t.target.x<t.source.x){var e=this.getBBox();return"rotate(180 "+(e.x+e.width/2)+" "+(e.y+e.height/2)+")"}return"rotate(0)"}))}function u(t){d3.event.active||s.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y}function f(t){t.fx=d3.event.x,t.fy=d3.event.y}d3.json("/api/zigbee/devices",(function(p,y){if(p)throw p;var g,h,v,x=(g=y,v={nodes:[h={id:"SLS GW",device:e}],links:[]},Object.entries(g).forEach((function(t){var e=t[0],n=t[1];v.nodes.push({id:e,device:n}),Array.isArray(n.Rtg)&&n.Rtg.length?n.Rtg.forEach((function(t){v.links.push({source:e,target:t.toString(),linkQuality:n.st.linkquality})})):v.links.push({source:e,target:h.id,linkQuality:n.st.linkquality})})),v);!function(e,p){(n=o.selectAll(".link").data(e).enter().append("line").attr("class","link").attr("viewBox","0 0 "+c+" "+l).attr("preserveAspectRatio","xMinYMin meet")).append("title").text((function(t){return t.type})),r=o.selectAll(".edgepath").data(e).enter().append("path").attr("class","edgepath").attr("fill-opacity",0).attr("stroke-opacity",0).attr("id",(function(t,e){return"edgepath"+e})).style("pointer-events","none"),(a=o.selectAll(".edgelabel").data(e).enter().append("text").style("pointer-events","none").attr("class","edgelabel").attr("id",(function(t,e){return"edgelabel"+e})).attr("font-size",10).attr("fill","#aaa")).append("textPath").attr("xlink:href",(function(t,e){return"#edgepath"+e})).style("text-anchor","middle").style("pointer-events","none").attr("startOffset","50%").text((function(t){return t.linkQuality})),(t=o.selectAll(".node").data(p).enter().append("g").attr("class","node").call(d3.drag().on("start",u).on("drag",f))).append("circle").attr("r",5).style("fill",(function(t,e){return i(e)})),t.append("title").text((function(t){return t.id})),t.append("text").attr("dy",-3).text((function(t){return e=t.device,n=e.friendly_name,r=e.ieeeAddr,n||r.slice(-4);var e,n,r})),s.nodes(p).on("tick",d),s.force("link").links(e)}(x.links,x.nodes)}))}()}();
